<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>GINCANA - Organizador</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 10px;
      padding-bottom: 90px;
    }

    h1 {
      text-align: center;
      font-size: 2.5rem;
      color: #fff;
      text-shadow: 3px 3px 12px rgba(0,0,0,0.4);
      margin: 20px 0 8px 0;
      font-weight: 900;
      letter-spacing: 1px;
    }

    .subtitle {
      text-align: center;
      font-size: 1rem;
      color: #fff;
      margin-bottom: 12px;
      opacity: 0.95;
      font-weight: 500;
    }

    .btn-reset {
      display: block;
      margin: 0 auto 20px auto;
      background: linear-gradient(135deg, #f5576c 0%, #c92a3e 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 12px;
      font-size: 0.95rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 4px 16px rgba(245, 87, 108, 0.4);
      transition: all 0.3s ease;
      max-width: 300px;
    }

    .btn-reset:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(245, 87, 108, 0.5);
    }

    .btn-reset:active {
      transform: scale(0.97);
    }

    .container {
      max-width: 520px;
      margin: 0 auto;
    }

    .card {
      background: white;
      padding: 24px;
      border-radius: 24px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.2);
      margin-bottom: 20px;
      transition: transform 0.2s ease;
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(0,0,0,0.25);
    }

    .card h2 {
      color: #667eea;
      margin-bottom: 18px;
      font-size: 1.5rem;
      font-weight: 800;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .brincadeira-item {
      background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
      border-radius: 16px;
      padding: 16px 20px;
      margin-bottom: 12px;
      box-shadow: 0 3px 12px rgba(102, 126, 234, 0.12);
      border: 2px solid #e8ecff;
      transition: all 0.3s ease;
    }

    .brincadeira-item:hover {
      box-shadow: 0 6px 18px rgba(102, 126, 234, 0.2);
      transform: translateY(-2px);
      border-color: #d0d9ff;
    }

    .brincadeira-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .brincadeira-nome {
      flex: 1;
      font-size: 1rem;
      font-weight: 700;
      color: #2d3748;
      line-height: 1.4;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .brincadeira-actions {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-shrink: 0;
    }

    .btn-pontuacao {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      color: white;
      cursor: pointer;
      padding: 10px 18px;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);
      transition: all 0.3s ease;
      font-size: 0.95rem;
      font-weight: 700;
      white-space: nowrap;
      touch-action: manipulation;
    }

    .btn-pontuacao:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-pontuacao:active {
      transform: scale(0.95);
    }

    .pontuacao-section {
      background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
      padding: 20px;
      border-radius: 16px;
      margin-top: 12px;
      box-shadow: 0 3px 12px rgba(102, 126, 234, 0.1);
      border: 2px solid #e8ecff;
      display: none;
    }

    .pontuacao-section.visible {
      display: block;
    }

    .pontuacao-section h3 {
      font-size: 1.1rem;
      font-weight: 800;
      color: #667eea;
      margin-bottom: 16px;
      text-align: center;
    }

    .lugar-controle {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
      gap: 14px;
    }

    .lugar-controle span {
      font-weight: 800;
      min-width: 80px;
      font-size: 1rem;
      color: #2d3748;
      background: linear-gradient(135deg, #667eea, #764ba2);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .lugar-controle select {
      flex: 1;
      padding: 14px 16px;
      border-radius: 12px;
      border: 2px solid #e2e8f0;
      background-color: white;
      font-size: 1rem;
      min-height: 52px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 700;
      color: #2d3748;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    
    .lugar-controle select:hover {
      border-color: #b8c5ff;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
    }

    .lugar-controle select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15), 0 4px 12px rgba(102, 126, 234, 0.2);
      transform: translateY(-1px);
    }

    .lugar-controle select option {
      padding: 12px;
      font-weight: 700;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 16px 24px;
      border-radius: 14px;
      font-size: 1.05rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.4);
      transition: all 0.3s ease;
      width: 100%;
      touch-action: manipulation;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }

    .btn-primary:active {
      transform: scale(0.97);
    }

    .btn-sortear {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      border: none;
      padding: 18px 26px;
      border-radius: 60px;
      font-size: 1.2rem;
      font-weight: 800;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(245, 87, 108, 0.5);
      z-index: 1000;
      transition: all 0.3s ease;
    }

    .btn-sortear:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 12px 32px rgba(245, 87, 108, 0.6);
    }

    .btn-sortear:active {
      transform: scale(0.92);
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(4px);
      z-index: 2000;
      justify-content: center;
      align-items: center;
      padding: 15px;
      animation: fadeIn 0.2s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.4);
      width: 100%;
      max-width: 400px;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from {
        transform: translateY(30px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .modal-content h2 {
      color: #667eea;
      margin-bottom: 20px;
      text-align: center;
      font-size: 1.8rem;
      font-weight: 800;
    }

    .modal-content input {
      width: 100%;
      padding: 16px;
      margin: 10px 0;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 1.05rem;
      transition: all 0.2s ease;
    }

    .modal-content input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }

    .modal-buttons {
      display: flex;
      gap: 12px;
      margin-top: 18px;
    }

    .modal-buttons button {
      flex: 1;
    }

    .btn-secondary {
      background: linear-gradient(135deg, #cbd5e0 0%, #a0aec0 100%);
      color: #2d3748;
    }

    .resultado-sorteio {
      font-size: 5rem;
      font-weight: 900;
      color: #667eea;
      text-align: center;
      margin: 30px 0;
      text-shadow: 2px 2px 8px rgba(102, 126, 234, 0.3);
    }

    .times-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      gap: 8px;
    }

    .time-card {
      padding: 10px;
      border-radius: 12px;
      color: white;
      font-weight: 800;
      text-align: center;
      font-size: 0.9rem;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
      position: relative;
      min-height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
      transition: all 0.3s ease;
      word-break: break-word;
      padding-right: 28px;
    }

    .time-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }

    .time-card .remove-time {
      position: absolute;
      top: 3px;
      right: 3px;
      background: rgba(0,0,0,0.6);
      border: none;
      color: white;
      border-radius: 50%;
      width: 22px;
      height: 22px;
      cursor: pointer;
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1;
      transition: all 0.2s ease;
    }

    .time-card .remove-time:hover {
      background: rgba(0,0,0,0.8);
      transform: scale(1.1);
    }

    .form-time {
      display: grid;
      grid-template-columns: 1fr 1fr 80px;
      gap: 10px;
      margin-bottom: 18px;
    }

    .form-time input,
    .form-time select {
      padding: 12px 14px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 0.95rem;
      transition: all 0.2s ease;
    }

    .form-time input:focus,
    .form-time select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
    }

    .form-time button {
      padding: 12px 20px;
      font-size: 0.95rem;
      white-space: nowrap;
    }

    .placar-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px;
      background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
      border-radius: 16px;
      margin-bottom: 12px;
      gap: 12px;
      box-shadow: 0 3px 12px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
      border: 2px solid #e8ecff;
    }

    .placar-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    }

    .placar-item .brincadeira-nome {
      flex: 1;
      font-weight: 700;
      color: #2d3748;
      font-size: 1rem;
    }

    .placar-item .vencedor {
      padding: 10px 18px;
      border-radius: 12px;
      color: white;
      font-weight: 800;
      font-size: 0.95rem;
      box-shadow: 0 3px 12px rgba(0,0,0,0.2);
      white-space: nowrap;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
    }

    .brincadeira-footer {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }

    .empty-state {
      text-align: center;
      color: #a0aec0;
      padding: 12px;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .contador-time {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px;
      background: #f8f9ff;
      border-radius: 12px;
      margin-bottom: 10px;
      gap: 10px;
      border: 2px solid #e8ecff;
    }

    .contador-time-nome {
      font-weight: 800;
      color: #2d3748;
      font-size: 1rem;
      flex: 1;
      padding: 8px 12px;
      border-radius: 8px;
      color: white;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
    }

    .contador-controles {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-contador {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      color: white;
      cursor: pointer;
      width: 36px;
      height: 36px;
      border-radius: 8px;
      font-size: 1.2rem;
      font-weight: 800;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
      transition: all 0.2s ease;
    }

    .btn-contador:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }

    .btn-contador:active {
      transform: scale(0.95);
    }

    .contador-valor {
      font-size: 1.3rem;
      font-weight: 900;
      color: #667eea;
      min-width: 40px;
      text-align: center;
      background: white;
      padding: 6px 12px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    }
  </style>
</head>
<body>
  <h1>üéâ GINCANA</h1>
  <p class="subtitle">Organize suas brincadeiras com estilo</p>
  <button class="btn-reset" onclick="resetarTudo()">üîÑ</button>

  <button class="btn-sortear" onclick="abrirSorteio()">üé≤</button>

  <div class="container">
    <div class="card">
      <h2>üèÜ Times</h2>
      <div class="form-time">
        <input type="text" id="nomeTime" placeholder="Nome do time">
        <select id="corTime">
          <option value="#ff0000">üî¥ Vermelho</option>
          <option value="#0000ff">üîµ Azul</option>
          <option value="#00ff00">üü¢ Verde</option>
          <option value="#ffff00">üü° Amarelo</option>
          <option value="#800080">üü£ Roxo</option>
          <option value="#ff69b4">ü©∑ Rosa</option>
          <option value="#ff8c00">üü† Laranja</option>
          <option value="#ffffff">‚ö™ Branco</option>
        </select>
        <button class="btn-primary" onclick="adicionarTime()">‚ûï OK</button>
      </div>
      <div class="times-container" id="timesContainer"></div>
    </div>

    <div class="card">
      <h2>üéÆ Brincadeiras</h2>
      <div id="brincadeirasLista"></div>
    </div>

    <div class="card">
      <h2>üõ†Ô∏è Ferramentas</h2>
      <div class="brincadeira-item">
        <div class="brincadeira-header">
          <span class="brincadeira-nome">Passo a Passo - Perguntas</span>
        </div>
        <div class="brincadeira-footer">
          <button class="btn-primary" id="btnPergunta" onclick="mostrarPergunta()">Pr√≥xima Pergunta</button>
          <div id="perguntaPassoAPasso" style="margin-top: 12px; padding: 16px; background: #fff; border-radius: 14px; min-height: 60px; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">
            <p id="textoPergunta" style="font-weight: 700; color: #2d3748; font-size: 1.15rem; line-height: 1.6;">Clique no bot√£o para come√ßar!</p>
          </div>
        </div>
      </div>
      
      <div class="brincadeira-item" style="margin-top: 16px;">
        <div class="brincadeira-header">
          <span class="brincadeira-nome">Passa ou Repassa - Contador</span>
        </div>
        <div class="brincadeira-footer">
          <div id="contadorPassaOuRepassa"></div>
          <button class="btn-primary" style="margin-top: 12px;" onclick="finalizarPassaOuRepassa()">‚úÖ Calcular Ranking</button>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>üìä Placar</h2>
      <div id="placarLista"></div>
    </div>
  </div>

  <div class="modal" id="modalSorteio">
    <div class="modal-content">
      <h2>üé≤ Sorteio</h2>
      <input type="number" id="minNum" placeholder="N√∫mero m√≠nimo" value="1">
      <input type="number" id="maxNum" placeholder="N√∫mero m√°ximo" value="100">
      <div class="modal-buttons">
        <button class="btn-primary" onclick="sortear()">Sortear!</button>
      </div>
      <div id="resultadoSorteio"></div>
      <div class="modal-buttons">
        <button class="btn-primary btn-secondary" onclick="fecharSorteio()">Fechar</button>
      </div>
    </div>
  </div>

  <script>
    const brincadeiras = [
      {nome: 'Corrida de saco', periodo: 'antes'},
      {nome: 'Estorar bal√£o no p√©', periodo: 'antes'},
      {nome: 'Colocar blusa sem deixar o bal√£o cair', periodo: 'antes'},
      {nome: 'N√≥', periodo: 'antes'},
      {nome: 'Passar bal√£o no meio das pernas', periodo: 'antes'},
      {nome: 'Passa ou Repassa (torta na cara/bexiga)', periodo: 'antes'},
      {nome: 'Passar trigo por carta', periodo: 'antes'},
      {nome: 'Constru√ß√£o de Torre', periodo: 'antes'},
      {nome: 'Ca√ßa ao Tesouro', periodo: 'antes'},
      {nome: 'Copo Envenenado', periodo: 'depois'},
      {nome: 'Captura Bexiga', periodo: 'depois'},
      {nome: 'Segurar o balde', periodo: 'depois'},
      {nome: 'Vara na cabe√ßa', periodo: 'depois'},
      {nome: 'Passar bexiga de √°gua para tr√°s', periodo: 'depois'},
      {nome: 'Tomar √°gua primeiro', periodo: 'depois'},
      {nome: 'Bingo', periodo: 'bingo'}
    ];

    let times = [];
    let brincadeirasAtivas = brincadeiras.map((item, i) => ({
      id: i, 
      nome: item.nome, 
      periodo: item.periodo,
      vencedores: []
    }));
    let brincadeirasFinalizadas = [];
    let passaOuRepassaAcertos = {};
    const PONTUACAO = {1: 15, 2: 10, 3: 5, 4: 0};

    function carregarDados() {
      try {
        const dadosSalvos = localStorage.getItem('gincanaData');
        if (dadosSalvos) {
          const dados = JSON.parse(dadosSalvos);
          if (dados.times) times = dados.times;
          if (dados.brincadeirasAtivas) brincadeirasAtivas = dados.brincadeirasAtivas;
          if (dados.brincadeirasFinalizadas) brincadeirasFinalizadas = dados.brincadeirasFinalizadas;
          if (dados.passaOuRepassaAcertos) passaOuRepassaAcertos = dados.passaOuRepassaAcertos;
        }
      } catch (e) {
        console.error('Erro ao carregar dados:', e);
      }
    }

    function salvarDados() {
      try {
        const dados = {
          times,
          brincadeirasAtivas,
          brincadeirasFinalizadas,
          passaOuRepassaAcertos
        };
        localStorage.setItem('gincanaData', JSON.stringify(dados));
      } catch (e) {
        console.error('Erro ao salvar dados:', e);
      }
    }

    function renderizarBrincadeiras() {
      const lista = document.getElementById('brincadeirasLista');
      lista.innerHTML = '';
      if (brincadeirasAtivas.length === 0) {
        lista.innerHTML = '<div class="empty-state">‚úÖ Todas as brincadeiras foram realizadas!</div>';
        renderizarPlacar();
        return;
      }
      brincadeirasAtivas.forEach((b) => {
        const div = document.createElement('div');
        div.className = 'brincadeira-item';
        
        const header = document.createElement('div');
        header.className = 'brincadeira-header';
        
        const nome = document.createElement('span');
        nome.className = 'brincadeira-nome';
        nome.textContent = b.nome;
        header.appendChild(nome);
        
        const actions = document.createElement('div');
        actions.className = 'brincadeira-actions';
        
        if (times.length > 0) {
          const btnPontuacao = document.createElement('button');
          btnPontuacao.className = 'btn-pontuacao';
          btnPontuacao.textContent = 'üìä Pontuar';
          btnPontuacao.onclick = () => togglePontuacao(b.id);
          actions.appendChild(btnPontuacao);
        }
        
        header.appendChild(actions);
        div.appendChild(header);
        
        if (times.length > 0) {
          const pontuacaoDiv = document.createElement('div');
          pontuacaoDiv.className = 'pontuacao-section';
          pontuacaoDiv.id = `pontuacao-${b.id}`;
          
          const pontuacaoTitle = document.createElement('h3');
          pontuacaoTitle.textContent = 'Pontua√ß√£o por Lugar';
          pontuacaoDiv.appendChild(pontuacaoTitle);
          
          for (let lugar = 1; lugar <= 4; lugar++) {
            const lugarDiv = document.createElement('div');
            lugarDiv.className = 'lugar-controle';
            const label = document.createElement('span');
            label.textContent = `${lugar}¬∫ (${PONTUACAO[lugar]} pts)`;
            const select = document.createElement('select');
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = 'Selecione...';
            select.appendChild(defaultOption);
            times.forEach(time => {
              const option = document.createElement('option');
              option.value = time.id;
              option.textContent = time.nome;
              option.style.backgroundColor = time.cor;
              option.style.color = 'white';
              option.style.fontWeight = '700';
              select.appendChild(option);
            });
            const vencedorId = b.vencedores.find(v => v.lugar === lugar)?.timeId;
            if (vencedorId) select.value = vencedorId;
            select.onchange = (e) => selecionarVencedor(b.id, lugar, parseInt(e.target.value));
            lugarDiv.appendChild(label);
            lugarDiv.appendChild(select);
            pontuacaoDiv.appendChild(lugarDiv);
          }
          
          const btnFinalizar = document.createElement('button');
          btnFinalizar.className = 'btn-primary';
          btnFinalizar.textContent = '‚úÖ Finalizar Brincadeira';
          btnFinalizar.style.marginTop = '12px';
          btnFinalizar.onclick = () => finalizarBrincadeira(b.id);
          pontuacaoDiv.appendChild(btnFinalizar);
          
          div.appendChild(pontuacaoDiv);
        }
        
        lista.appendChild(div);
      });
      renderizarPlacar();
      salvarDados();
    }

    function togglePontuacao(id) {
      const pontuacaoDiv = document.getElementById(`pontuacao-${id}`);
      if (pontuacaoDiv) {
        pontuacaoDiv.classList.toggle('visible');
      }
    }

    function removerBrincadeira(id) {
      const brincadeira = brincadeirasAtivas.find(b => b.id === id);
      if (brincadeira) {
        brincadeirasFinalizadas.push({...brincadeira});
      }
      brincadeirasAtivas = brincadeirasAtivas.filter(b => b.id !== id);
      renderizarBrincadeiras();
    }

    function finalizarBrincadeira(id) {
      if (confirm('Finalizar esta brincadeira e passar para a pr√≥xima?')) {
        removerBrincadeira(id);
      }
    }

    function adicionarTime() {
      const nome = document.getElementById('nomeTime').value.trim();
      const cor = document.getElementById('corTime').value;
      if (!nome) {
        alert('Digite o nome do time!');
        return;
      }
      const timeId = Date.now();
      times.push({ id: timeId, nome, cor, pontuacao: 0 });
      passaOuRepassaAcertos[timeId] = 0;
      document.getElementById('nomeTime').value = '';
      renderizarTimes();
      renderizarBrincadeiras();
      renderizarContadorPassaOuRepassa();
      salvarDados();
    }

    function removerTime(id) {
      if (!confirm('Remover este time?')) return;
      times = times.filter(t => t.id !== id);
      delete passaOuRepassaAcertos[id];
      const limparVencedores = (brincadeira) => {
        brincadeira.vencedores = brincadeira.vencedores.filter(v => v.timeId !== id);
      };
      brincadeirasAtivas.forEach(limparVencedores);
      brincadeirasFinalizadas.forEach(limparVencedores);
      renderizarTimes();
      renderizarBrincadeiras();
      renderizarContadorPassaOuRepassa();
      salvarDados();
    }

    function renderizarTimes() {
      const container = document.getElementById('timesContainer');
      container.innerHTML = '';
      if (times.length === 0) {
        return;
      }
      times.forEach(time => {
        const card = document.createElement('div');
        card.className = 'time-card';
        card.style.backgroundColor = time.cor;
        card.innerHTML = `${time.nome}<button class="remove-time" onclick="removerTime(${time.id})">√ó</button>`;
        container.appendChild(card);
      });
    }

    function selecionarVencedor(brincadeiraId, lugar, timeId) {
      const brincadeira = brincadeirasAtivas.find(b => b.id === brincadeiraId);
      if (!brincadeira) return;
      brincadeira.vencedores = brincadeira.vencedores.filter(v => v.timeId !== timeId);
      brincadeira.vencedores = brincadeira.vencedores.filter(v => v.lugar !== lugar);
      if (timeId) brincadeira.vencedores.push({ lugar, timeId });
      brincadeira.vencedores.sort((a, b) => a.lugar - b.lugar);
      renderizarBrincadeiras();
      salvarDados();
    }
    
    function calcularPontuacaoTotal() {
      times.forEach(t => t.pontuacao = 0);
      const todasBrincadeiras = [...brincadeirasAtivas, ...brincadeirasFinalizadas];
      todasBrincadeiras.forEach(b => {
        b.vencedores.forEach(vencedor => {
          const pontos = PONTUACAO[vencedor.lugar];
          const time = times.find(t => t.id === vencedor.timeId);
          if (time && pontos !== undefined) time.pontuacao += pontos;
        });
      });
    }

    function renderizarPlacar() {
      calcularPontuacaoTotal();
      const lista = document.getElementById('placarLista');
      lista.innerHTML = '';
      const timesOrdenados = [...times].sort((a, b) => b.pontuacao - a.pontuacao);
      if (timesOrdenados.length === 0) {
        lista.innerHTML = '<div class="empty-state">Adicione times para ver o placar.</div>';
        return;
      }
      
      const placarGeralTitle = document.createElement('h3');
      placarGeralTitle.textContent = 'üèÜ Ranking Geral';
      placarGeralTitle.style.fontSize = '1.3rem';
      placarGeralTitle.style.fontWeight = '800';
      placarGeralTitle.style.color = '#667eea';
      placarGeralTitle.style.marginBottom = '12px';
      lista.appendChild(placarGeralTitle);

      timesOrdenados.forEach((time, index) => {
        const item = document.createElement('div');
        item.className = 'placar-item';
        item.style.backgroundColor = '#f8f9ff';
        item.style.borderLeft = `6px solid ${time.cor}`;
        const nome = document.createElement('span');
        nome.className = 'brincadeira-nome';
        nome.textContent = `${index + 1}¬∫ ${time.nome}`;
        nome.style.color = '#2d3748';
        nome.style.fontWeight = '800';
        const pontuacao = document.createElement('span');
        pontuacao.className = 'vencedor';
        pontuacao.textContent = `${time.pontuacao} pts`;
        pontuacao.style.backgroundColor = time.cor;
        pontuacao.style.color = 'white';
        item.appendChild(nome);
        item.appendChild(pontuacao);
        lista.appendChild(item);
      });
      
      const todasComVencedor = [...brincadeirasFinalizadas.filter(b => b.vencedores.length > 0)];
      if (todasComVencedor.length > 0) {
        const detalheTitle = document.createElement('h3');
        detalheTitle.textContent = 'üìù Hist√≥rico de Brincadeiras';
        detalheTitle.style.fontSize = '1.3rem';
        detalheTitle.style.fontWeight = '800';
        detalheTitle.style.color = '#667eea';
        detalheTitle.style.marginTop = '24px';
        detalheTitle.style.marginBottom = '12px';
        lista.appendChild(detalheTitle);
        todasComVencedor.reverse().forEach(b => {
          const div = document.createElement('div');
          div.className = 'placar-item';
          div.style.flexDirection = 'column';
          div.style.alignItems = 'flex-start';
          div.style.backgroundColor = '#f8f9ff';
          const nomeBrincadeira = document.createElement('span');
          nomeBrincadeira.className = 'brincadeira-nome';
          nomeBrincadeira.textContent = b.nome;
          nomeBrincadeira.style.color = '#2d3748';
          nomeBrincadeira.style.marginBottom = '8px';
          nomeBrincadeira.style.fontSize = '1.05rem';
          div.appendChild(nomeBrincadeira);
          b.vencedores.forEach(vencedor => {
            const time = times.find(t => t.id === vencedor.timeId);
            if (time) {
              const vencedorItem = document.createElement('span');
              vencedorItem.className = 'vencedor';
              vencedorItem.style.backgroundColor = time.cor;
              vencedorItem.textContent = `${vencedor.lugar}¬∫: ${time.nome} (+${PONTUACAO[vencedor.lugar]} pts)`;
              vencedorItem.style.marginRight = '8px';
              vencedorItem.style.marginBottom = '8px';
              div.appendChild(vencedorItem);
            }
          });
          lista.appendChild(div);
        });
      }
    }

    function abrirSorteio() {
      document.getElementById('modalSorteio').classList.add('active');
      document.getElementById('resultadoSorteio').innerHTML = '';
    }

    function fecharSorteio() {
      document.getElementById('modalSorteio').classList.remove('active');
    }

    const PERGUNTAS_PASSO_A_PASSO = [
  { pergunta: 'Qual √© o planeta conhecido como "Planeta Vermelho"?', resposta: 'Marte' },
  { pergunta: 'Qual √© o coletivo de c√£es?', resposta: 'Matilha' },
  { pergunta: 'Qual √© a capital da Fran√ßa?', resposta: 'Paris' },
  { pergunta: 'Que animal tem 8 bra√ßos?', resposta: 'Polvo' },
  { pergunta: 'Qual √© o coletivo de peixes?', resposta: 'Cardume' },
  { pergunta: 'Quem pintou a Mona Lisa?', resposta: 'Leonardo da Vinci' },
  { pergunta: 'Qual √© o coletivo de lobos?', resposta: 'Alcateia' },
  { pergunta: 'Quanto √© 7 √ó 7?', resposta: '49' },
  { pergunta: 'Qual √© o maior animal do planeta?', resposta: 'Baleia-azul' },
  { pergunta: 'Qual √© o coletivo de porcos?', resposta: 'Vara' },
  { pergunta: 'Qual √© o plural de p√£o?', resposta: 'P√£es' },
  { pergunta: 'Que profissional cuida dos dentes?', resposta: 'Dentista' },
  { pergunta: 'Qual √© o coletivo de macacos?', resposta: 'Bando' },
  { pergunta: 'Qual √© a metade de 20?', resposta: '10' },
  { pergunta: 'Quem foi o autor de "Romeu e Julieta"?', resposta: 'William Shakespeare' },
  { pergunta: 'Qual √© o coletivo de cabras ou ovelhas?', resposta: 'Rebanho' },
  { pergunta: 'Qual √© o peixe-palha√ßo protagonista de "Procurando Nemo"?', resposta: 'Nemo' },
  { pergunta: 'Qual √© o maior planeta do Sistema Solar?', resposta: 'J√∫piter' },
  { pergunta: 'Qual √© o coletivo de p√°ssaros em geral?', resposta: 'Bando ou revoada' },
  { pergunta: 'Que pa√≠s √© famoso pela Torre Eiffel?', resposta: 'Fran√ßa' },
  { pergunta: 'Qual √© o plural de charlat√£o?', resposta: 'Charlat√£es' },
  { pergunta: 'Quanto √© 100 √∑ 10?', resposta: '10' },
  { pergunta: 'Como se chama o cachorro do Mickey?', resposta: 'Pluto' },
  { pergunta: 'Quantos dias tem um ano bissexto?', resposta: '366' },
  { pergunta: 'Em que continente fica o Egito?', resposta: '√Åfrica' },
  { pergunta: 'Que animal √© famoso por mudar de cor?', resposta: 'Camale√£o' },
  { pergunta: 'Qual √© o nome do processo das plantas produzirem seu alimento?', resposta: 'Fotoss√≠ntese' },
  { pergunta: 'Quem foi o primeiro presidente do Brasil?', resposta: 'Deodoro da Fonseca' },
  { pergunta: 'Como se chama o melhor amigo do Shrek?', resposta: 'Burro' },
  { pergunta: 'Em que oceano fica o Brasil?', resposta: 'Atl√¢ntico' },
  { pergunta: 'Qual √© o maior √≥rg√£o do corpo humano?', resposta: 'Pele' },
  { pergunta: 'Em "Turma da M√¥nica", qual √© o maior rival da M√¥nica?', resposta: 'Cebolinha' },
  { pergunta: 'O que mede um term√¥metro?', resposta: 'Temperatura' },
  { pergunta: 'Quem √© o protagonista de "Harry Potter"?', resposta: 'Harry Potter' },
  { pergunta: 'De que fruta √© feito o vinho?', resposta: 'Uva' },
  { pergunta: 'Em "Carros", qual √© o nome do carro vermelho protagonista?', resposta: 'Rel√¢mpago McQueen' },
  { pergunta: 'Que cor resulta da mistura de azul + amarelo?', resposta: 'Verde' },
  { pergunta: 'Quantos ossos tem o corpo humano adulto?', resposta: '206' },
  { pergunta: 'Quem √© o pai do Simba?', resposta: 'Mufasa' },
  { pergunta: 'Quantos estados tem o Brasil?', resposta: '26 + Distrito Federal' },
  { pergunta: 'Que som a vaca faz?', resposta: 'Muuuuu' },
  { pergunta: 'Quem √© o protagonista do filme "Homem de Ferro"?', resposta: 'Tony Stark' },
  { pergunta: 'Quantas cores tem o arco-√≠ris?', resposta: '7' },
  { pergunta: 'Qual √© o maior oceano do mundo?', resposta: 'Oceano Pac√≠fico' },
  { pergunta: 'Qual √© o elemento qu√≠mico representado por "O"?', resposta: 'Oxig√™nio' },
  { pergunta: 'Qual √© o super-her√≥i conhecido como "Homem-Morcego"?', resposta: 'Batman' },
  { pergunta: 'Quanto √© 4 √ó 0?', resposta: '0' },
  { pergunta: 'Que animal p√µe ovos e tem bico, mas n√£o √© um p√°ssaro?', resposta: 'Ornitorrinco' },
  { pergunta: 'Qual √© o plural de m√£o?', resposta: 'M√£os' },
  { pergunta: 'Que tipo de animal √© a tartaruga?', resposta: 'R√©ptil' },
  { pergunta: 'Qual √© o maior pa√≠s da Am√©rica do Sul?', resposta: 'Brasil' },
  { pergunta: 'Em "Kung Fu Panda", qual √© o nome do panda protagonista?', resposta: 'Po' },
  { pergunta: 'Qual princesa da Disney perde o sapatinho de cristal?', resposta: 'Cinderela' },
  { pergunta: 'Em "A Fant√°stica F√°brica de Chocolate", qual √© o nome do dono da f√°brica?', resposta: 'Willy Wonka' },
  { pergunta: 'Quanto √© 9 √ó 9?', resposta: '81' },
  { pergunta: 'Que animal √© conhecido como "rei da selva"?', resposta: 'Le√£o' },
  { pergunta: 'Quantos lados tem um oct√≥gono?', resposta: '8' },
  { pergunta: 'Quantos meses tem um ano?', resposta: '12' }
];

    let perguntaAtualIndex = -1;
    let mostrandoResposta = false;
    
    function mostrarPergunta() {
      if (mostrandoResposta) {
        perguntaAtualIndex = (perguntaAtualIndex + 1) % PERGUNTAS_PASSO_A_PASSO.length;
        mostrandoResposta = false;
        document.getElementById('btnPergunta').textContent = 'Mostrar Resposta';
      } else {
        mostrandoResposta = true;
        document.getElementById('btnPergunta').textContent = 'Pr√≥xima Pergunta';
      }
      const item = PERGUNTAS_PASSO_A_PASSO[perguntaAtualIndex];
      if (perguntaAtualIndex === -1) {
        perguntaAtualIndex = 0;
        document.getElementById('btnPergunta').textContent = 'Mostrar Resposta';
      }
      const texto = mostrandoResposta ? `‚úÖ Resposta: ${item.resposta}` : `‚ùì ${item.pergunta}`;
      document.getElementById('textoPergunta').textContent = texto;
    }

    function sortear() {
      const min = parseInt(document.getElementById('minNum').value) || 1;
      const max = parseInt(document.getElementById('maxNum').value) || 100;
      if (min > max) {
        alert('O n√∫mero m√≠nimo deve ser menor que o m√°ximo!');
        return;
      }
      const resultado = Math.floor(Math.random() * (max - min + 1)) + min;
      document.getElementById('resultadoSorteio').innerHTML = `<div class="resultado-sorteio">${resultado}</div>`;
    }

    function renderizarContadorPassaOuRepassa() {
      const container = document.getElementById('contadorPassaOuRepassa');
      container.innerHTML = '';
      
      if (times.length === 0) {
        container.innerHTML = '<div class="empty-state">Adicione times primeiro</div>';
        return;
      }
      
      times.forEach(time => {
        if (!passaOuRepassaAcertos[time.id]) {
          passaOuRepassaAcertos[time.id] = 0;
        }
        
        const div = document.createElement('div');
        div.className = 'contador-time';
        
        const nomeDiv = document.createElement('div');
        nomeDiv.className = 'contador-time-nome';
        nomeDiv.textContent = time.nome;
        nomeDiv.style.backgroundColor = time.cor;
        
        const controles = document.createElement('div');
        controles.className = 'contador-controles';
        
        const btnMenos = document.createElement('button');
        btnMenos.className = 'btn-contador';
        btnMenos.textContent = '‚àí';
        btnMenos.onclick = () => {
          if (passaOuRepassaAcertos[time.id] > 0) {
            passaOuRepassaAcertos[time.id]--;
            renderizarContadorPassaOuRepassa();
            salvarDados();
          }
        };
        
        const valor = document.createElement('span');
        valor.className = 'contador-valor';
        valor.textContent = passaOuRepassaAcertos[time.id];
        
        const btnMais = document.createElement('button');
        btnMais.className = 'btn-contador';
        btnMais.textContent = '+';
        btnMais.onclick = () => {
          passaOuRepassaAcertos[time.id]++;
          renderizarContadorPassaOuRepassa();
          salvarDados();
        };
        
        controles.appendChild(btnMenos);
        controles.appendChild(valor);
        controles.appendChild(btnMais);
        
        div.appendChild(nomeDiv);
        div.appendChild(controles);
        
        container.appendChild(div);
      });
    }

    function finalizarPassaOuRepassa() {
      if (times.length === 0) {
        alert('Adicione times primeiro!');
        return;
      }
      
      const brincadeira = brincadeirasAtivas.find(b => b.nome === 'Passa ou Repassa (torta na cara/bexiga)');
      if (!brincadeira) {
        alert('Brincadeira "Passa ou Repassa" n√£o encontrada!');
        return;
      }
      
      const ranking = times.map(t => ({
        id: t.id,
        nome: t.nome,
        acertos: passaOuRepassaAcertos[t.id] || 0
      })).sort((a, b) => b.acertos - a.acertos);
      
      brincadeira.vencedores = [];
      ranking.forEach((item, index) => {
        const lugar = index + 1;
        if (lugar <= 4) {
          brincadeira.vencedores.push({ lugar, timeId: item.id });
        }
      });
      
      const mensagem = `Ranking calculado!\n\n${ranking.map((r, i) => `${i + 1}¬∫: ${r.nome} - ${r.acertos} acertos`).join('\n')}\n\nA brincadeira ser√° finalizada automaticamente.`;
      
      alert(mensagem);
      
      // Finaliza automaticamente a brincadeira
      removerBrincadeira(brincadeira.id);
      
      // Limpa os contadores para pr√≥xima vez
      times.forEach(t => {
        passaOuRepassaAcertos[t.id] = 0;
      });
      
      renderizarContadorPassaOuRepassa();
      salvarDados();
    }

    function resetarTudo() {
      const confirmar = confirm('‚ö†Ô∏è ATEN√á√ÉO!\n\nIsso vai apagar TODOS os dados:\n‚Ä¢ Times cadastrados\n‚Ä¢ Brincadeiras finalizadas\n‚Ä¢ Placar completo\n‚Ä¢ Contadores\n\nTem certeza que deseja come√ßar uma nova gincana?');
      
      if (!confirmar) return;
      
      // Limpa todos os dados
      times = [];
      brincadeirasAtivas = brincadeiras.map((item, i) => ({
        id: i, 
        nome: item.nome, 
        periodo: item.periodo,
        vencedores: []
      }));
      brincadeirasFinalizadas = [];
      passaOuRepassaAcertos = {};
      perguntaAtualIndex = -1;
      mostrandoResposta = false;
      
      // Limpa localStorage
      localStorage.removeItem('gincanaData');
      
      // Atualiza interface
      renderizarTimes();
      renderizarBrincadeiras();
      renderizarContadorPassaOuRepassa();
      document.getElementById('textoPergunta').textContent = 'Clique no bot√£o para come√ßar!';
      document.getElementById('btnPergunta').textContent = 'Pr√≥xima Pergunta';
      
      alert('‚úÖ Tudo foi resetado! Pode come√ßar uma nova gincana.');
    }

    carregarDados();
    renderizarBrincadeiras();
    renderizarTimes();
    renderizarContadorPassaOuRepassa();
  </script>
</body>
</html>
